{
  "name": "ğŸ“± PRODUÃ‡ÃƒO - Airdrops â†’ WhatsApp",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "hours",
              "hoursInterval": 6
            }
          ]
        }
      },
      "id": "schedule-6h",
      "name": "â° A cada 6 horas",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [240, 300]
    },
    {
      "parameters": {
        "url": "https://SEU-APP.onrender.com/health",
        "options": {}
      },
      "id": "check-health",
      "name": "ğŸ¥ Verificar API",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [460, 300]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "condition1",
              "leftValue": "={{ $json.status }}",
              "rightValue": "online",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        }
      },
      "id": "api-online",
      "name": "ğŸ” API Online?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [680, 300]
    },
    {
      "parameters": {
        "url": "https://SEU-APP.onrender.com/n8n/best-airdrops",
        "options": {
          "queryParametersUi": {
            "parameter": [
              {
                "name": "limit",
                "value": "5"
              }
            ]
          }
        }
      },
      "id": "get-airdrops",
      "name": "ğŸš€ Buscar Top 5 Airdrops",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [900, 200]
    },
    {
      "parameters": {
        "jsCode": "// Formatar mensagem para WhatsApp\nconst data = $input.first().json;\nconst airdrops = data.airdrops || [];\n\nif (airdrops.length === 0) {\n  return {\n    skip: true,\n    message: 'Nenhum airdrop encontrado'\n  };\n}\n\n// Criar mensagem formatada\nlet message = 'ğŸš€ *TOP ' + airdrops.length + ' AIRDROPS DO MOMENTO*\\n\\n';\n\n// Emojis para chains\nconst chainEmojis = {\n  'ETH': 'ğŸ”·',\n  'ETHEREUM': 'ğŸ”·',\n  'BSC': 'ğŸŸ¡', \n  'POLYGON': 'ğŸŸ£',\n  'ARBITRUM': 'ğŸ”µ',\n  'OPTIMISM': 'ğŸ”´',\n  'SOLANA': 'ğŸŸ¢',\n  'SOL': 'ğŸŸ¢',\n  'AVAX': 'âšª'\n};\n\n// Emojis para status\nconst statusEmojis = {\n  'ACTIVE': 'âœ…',\n  'TBD': 'â³',\n  'ENDED': 'âŒ',\n  'UPCOMING': 'ğŸ”œ'\n};\n\nairdrops.forEach((airdrop, index) => {\n  const chainEmoji = chainEmojis[airdrop.chain?.toUpperCase()] || 'â›“ï¸';\n  const statusEmoji = statusEmojis[airdrop.status?.toUpperCase()] || 'ğŸ“Š';\n  \n  message += `${index + 1}. *${airdrop.name}*\\n`;\n  message += `ğŸ’° Valor: ${airdrop.value}\\n`;\n  message += `${chainEmoji} Chain: ${airdrop.chain || 'Multi'}\\n`;\n  message += `${statusEmoji} Status: ${airdrop.status}\\n`;\n  \n  if (airdrop.deadline) {\n    message += `â° Deadline: ${airdrop.deadline}\\n`;\n  }\n  \n  message += '\\n';\n});\n\nmessage += `_ğŸ• Atualizado: ${new Date().toLocaleString('pt-BR')}_\\n`;\nmessage += '_ğŸ“Š Dados via DeFiLlama MCP_\\n';\nmessage += '_ğŸ¤– Enviado automaticamente a cada 6h_';\n\nreturn {\n  message: message,\n  count: airdrops.length,\n  timestamp: new Date().toISOString(),\n  airdrops: airdrops\n};"
      },
      "id": "format-message",
      "name": "âœï¸ Formatar Mensagem",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1120, 200]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "condition1",
              "leftValue": "={{ $json.skip }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "notEqual"
              }
            },
            {
              "id": "condition2",
              "leftValue": "={{ $json.count }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        }
      },
      "id": "has-airdrops",
      "name": "ğŸ“Š Tem Airdrops?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [1340, 200]
    },
    {
      "parameters": {
        "url": "http://localhost:8080/message/sendText/SUA-INSTANCIA",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {
          "bodyContentType": "json",
          "jsonBody": "{\n  \"number\": \"5511999999999@c.us\",\n  \"text\": \"{{ $json.message }}\"\n}",
          "headers": {
            "apikey": "SUA_API_KEY_EVOLUTION",\n            "Content-Type": "application/json"\n          }\n        },\n        "method": "POST"\n      },\n      "id": "send-whatsapp",\n      "name": "ğŸ“± Enviar WhatsApp",\n      "type": "n8n-nodes-base.httpRequest",\n      "typeVersion": 4.1,\n      "position": [1560, 120]\n    },\n    {\n      "parameters": {\n        "message": "âš ï¸ API DeFiLlama offline ou sem resposta",\n        "options": {}\n      },\n      "id": "api-offline-error",\n      "name": "âŒ API Offline",\n      "type": "n8n-nodes-base.stopAndError",\n      "typeVersion": 1,\n      "position": [680, 500]\n    },\n    {\n      "parameters": {\n        "jsCode": "// Log de sucesso\\nconsole.log('âœ… Mensagem enviada com sucesso para WhatsApp');\\nconsole.log('ğŸ“Š Airdrops enviados:', $input.first().json.count);\\nconst response = $input.first().json;\\n\\nreturn {\\n  status: 'success',\\n  message: 'Airdrops enviados para WhatsApp',\\n  count: $('âœï¸ Formatar Mensagem').first().json.count,\\n  timestamp: new Date().toISOString(),\\n  whatsapp_response: response\\n};"\n      },\n      "id": "log-success",\n      "name": "âœ… Log Sucesso",\n      "type": "n8n-nodes-base.code",\n      "typeVersion": 2,\n      "position": [1780, 120]\n    },\n    {\n      "parameters": {\n        "url": "http://localhost:8080/message/sendText/SUA-INSTANCIA",\n        "authentication": "genericCredentialType",\n        "genericAuthType": "httpHeaderAuth",\n        "options": {\n          "bodyContentType": "json",\n          "jsonBody": "{\n  \"number\": \"5511999999999@c.us\",\n  \"text\": \"âš ï¸ *Aviso Sistema*\\n\\nNenhum airdrop encontrado no momento.\\n\\n_Sistema funcionando normalmente_\\n_PrÃ³xima verificaÃ§Ã£o em 6 horas_\"\n}",\n          "headers": {\n            "apikey": "SUA_API_KEY_EVOLUTION",\n            "Content-Type": "application/json"\n          }\n        },\n        "method": "POST"\n      },\n      "id": "send-no-airdrops",\n      "name": "ğŸ“± Aviso: Sem Airdrops",\n      "type": "n8n-nodes-base.httpRequest",\n      "typeVersion": 4.1,\n      "position": [1560, 300]\n    }\n  ],\n  "connections": {\n    "â° A cada 6 horas": {\n      "main": [\n        [\n          {\n            "node": "ğŸ¥ Verificar API",\n            "type": "main",\n            "index": 0\n          }\n        ]\n      ]\n    },\n    "ğŸ¥ Verificar API": {\n      "main": [\n        [\n          {\n            "node": "ğŸ” API Online?",\n            "type": "main",\n            "index": 0\n          }\n        ]\n      ]\n    },\n    "ğŸ” API Online?": {\n      "main": [\n        [\n          {\n            "node": "ğŸš€ Buscar Top 5 Airdrops",\n            "type": "main",\n            "index": 0\n          }\n        ],\n        [\n          {\n            "node": "âŒ API Offline",\n            "type": "main",\n            "index": 0\n          }\n        ]\n      ]\n    },\n    "ğŸš€ Buscar Top 5 Airdrops": {\n      "main": [\n        [\n          {\n            "node": "âœï¸ Formatar Mensagem",\n            "type": "main",\n            "index": 0\n          }\n        ]\n      ]\n    },\n    "âœï¸ Formatar Mensagem": {\n      "main": [\n        [\n          {\n            "node": "ğŸ“Š Tem Airdrops?",\n            "type": "main",\n            "index": 0\n          }\n        ]\n      ]\n    },\n    "ğŸ“Š Tem Airdrops?": {\n      "main": [\n        [\n          {\n            "node": "ğŸ“± Enviar WhatsApp",\n            "type": "main",\n            "index": 0\n          }\n        ],\n        [\n          {\n            "node": "ğŸ“± Aviso: Sem Airdrops",\n            "type": "main",\n            "index": 0\n          }\n        ]\n      ]\n    },\n    "ğŸ“± Enviar WhatsApp": {\n      "main": [\n        [\n          {\n            "node": "âœ… Log Sucesso",\n            "type": "main",\n            "index": 0\n          }\n        ]\n      ]\n    }\n  },\n  "pinData": {},\n  "settings": {\n    "executionOrder": "v1"\n  },\n  "staticData": null,\n  "tags": [\n    {\n      "id": "prod",\n      "name": "produÃ§Ã£o"\n    },\n    {\n      "id": "whatsapp",\n      "name": "whatsapp"\n    }\n  ],\n  "triggerCount": 1,\n  "updatedAt": "2024-01-01T00:00:00.000Z",\n  "versionId": "1"\n}